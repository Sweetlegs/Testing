{%- assign fixed_aspect_ratio = false -%}
{%- assign image_size = 'natural' -%}

<div id="section-{{ section.id }}" data-section-id="{{ section.id }}" data-section-type="blocks">
  <div class="page-width page-content">
    <div class="blog-template__container">
      <h2 class="span-head__style popitheading text-left">
        {{section.settings.title}}
      </h2>
      <div class="grid grid--uniform MasonGrid">
        
        {% for blocks in section.blocks %}
          <div class="grid__item medium-up--one-third" data-aos="row-of-{{ per_row }}">
          <div class="grid">
            <div class="grid__item">       
              {% if blocks.settings.image %}
              <a href="{{ article.url }}" class="article__grid-image">
                {% if fixed_aspect_ratio %}
                <div class="image-wrap">
                  <div
                       class="grid__image-ratio grid__image-ratio--cover grid__image-ratio--{{ image_size }} lazyload"
                       data-bgset="{% include 'bgset', image: blocks.settings.image %}"
                       data-sizes="auto">
                  </div>
                  <noscript>
                    <img class="lazyloaded" src="{{ blocks.settings.image | img_url: '400x' }}" alt="{{ article.title | escape }}">
                  </noscript>
                </div>
                {% else %}
                <div class="image-wrap" style="height: 0; padding-bottom: {{ 100 | divided_by: blocks.settings.image.aspect_ratio }}%;">
                  {%- assign img_url = blocks.settings.image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
                  <img class="lazyload"
                       data-src="{{ img_url }}"
                       data-widths="[180, 360, 540, 720, 900, 1080]"
                       data-aspectratio="{{ blocks.settings.image.aspect_ratio }}"
                       data-sizes="auto"
                       alt="{{ blocks.settings.image.alt | escape }}">
                  <noscript>
                    <img class="lazyloaded" src="{{ blocks.settings.image | img_url: '400x' }}" alt="{{ article.title | escape }}">
                  </noscript>
                </div>
                {% endif %}
              </a>
              {% endif %}
            </div>
            <div class="grid__item">
              <div class="article__grid-meta {% if template == 'index' %}center{% endif %}">
                
                <a href="{{ blocks.settings.link }}" class="article__title" >{{ blocks.settings.title }}</a>
                <div class="rte article__excerpt">
                  {{blocks.settings.content | strip_html}}
                </div>

                <div>
                  <a href="{{ blocks.settings.link }}" class="btn btn-secondary">Shop now</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
        
      </div>
    </div>
  </div>
</div>
{% schema %}
  {
    "name": "Products",
	"settings": [
	  {
		"type": "textarea",
		"id": "title",
		"label": "Title",
		"default": "Press releases"
	  }
	],
    "blocks": [
      {
        "type": "product",
        "name": "Product",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "id": "title",
            "type": "text",
            "label": "Title"
          },
          {
            "id": "content",
            "type": "richtext",
            "label": "Content"
          },
          {
            "id": "link",
            "type": "url",
            "label": "Link"
          }
        ]
      }
    ]
  }
{% endschema %}