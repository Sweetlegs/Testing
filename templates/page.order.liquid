{{ 'quick-order.css' | asset_url | stylesheet_tag }} 
  {% for item in cart.items %}
      <script type="text/javascript">
        itemProductType = '{{item.product.type | downcase}}';   
        if(customerTags.includes("new")) {
          checkProductType = itemProductType.includes('sweetlegs') ||  itemProductType.includes('shorts');
        } else {
          checkProductType = itemProductType.includes('sweetlegs') || itemProductType.includes('sweettops') || itemProductType.includes('shorts');
        }
        if (checkProductType){ 
           if(window.discountableItem) {
              discountableItem = discountableItem + parseInt(`{{item.quantity}}`);
            } else {
              window.discountableItem = 0;
               discountableItem = discountableItem + parseInt(`{{item.quantity}}`);
            }
        } else { 
          if(window.discountableItem) {
              discountableItem = window.discountableItem;
            } else {
              window.discountableItem = 0;
               discountableItem = window.discountableItem;
            }
        }
          
        if(window.carts) {         
          item = {
             variantId : '{{item.variant_id}}',
             quantity: '{{item.quantity}}'
           }
           carts.push(item); 
        } else {
           window.carts = [];  
                     item = {
                     variantId : '{{item.variant_id}}',
                     quantity: '{{item.quantity}}'
                     }
            carts.push(item); 
        }                  
      </script> 
  {% endfor %}


<div id="spinner">
  {{ 'loading.gif' | asset_url | img_tag: 'spin', 'spin' }}
  <p>Loading ...</p>
</div>
<div id="primary" class="content-area">
  {%- include 'page-header' -%}
  <div id="content" class="site-content">
    <article class="page">
      <div class="row">
        <div class="large-12 columns">
          <div class="entry-content">
          </div>  
    </div>
   </div>       
{% assign collHandle = 'quick-order' %}             
{% assign collection = collections[collHandle] %}  
{% assign collVaultHandle = 'vault-prints' %}             
{% assign collectionVault = collections[collVaultHandle] %}
{% assign collFeaturedHandle = 'featured-prints' %}             
{% assign collectionFeatured = collections[collFeaturedHandle] %} 
{% assign total = cart.attributes.pagination %}
{% assign searchTag = cart.attributes.tag %}
{% assign searchType = cart.attributes.search %}
{% assign totalLineItem = 0 %}
{% assign discountableItem = 0 %}
{% assign count = 0 %}
{% assign productTags = product.tags | join: ', ' %}
{% assign counter = 0 %}
{% comment %}
Source: https://gist.github.com/carolineschnapp/9122054
{% endcomment %}

<div class="paginationForm">

{% paginate collection.products by 50 %}
<form action="/cart" method="post" class="orderForm">
  <div class="row">
    <div class="large-12 columns" style="text-align: left">
      {% if collection.products_count > 0 %}

      
<!--        <h1>{% if template contains 'page' %}{{ page.title }}{% else %}{{ collection.title }}{% endif %}</h1>
      {% endif %} -->
     
      {% if template contains 'page' and page.content.size > 0 %}
       
      {% elsif collection.description.size > 0 %}
        <div class="rte">
          {{ collection.description }}
        </div>
      {% endif %}    
      {% if collection.products_count > 0 %}
       <div id="errorCart" class="hideMe alert alert-success" role="alert"></div> 
        <div class="filterBoxWrap">
      <div class="filterBox fBox">
                <label>Search</label>
                <input type="search" class="form-control" placeholder="Search Product">
      </div> 
            <div class="fBox cat">
                <label>Category</label>
                <select class="catFilter">  
                     <option selected value></option>
                      <option value="Accessories">Accessories</option>
                      <option value="shorts">Biker Shorts</option>
                      <option value="Sweetlegs One Size">SweetLegs one size</option>
                      <option value="Sweetlegs Plus">SweetLegs Plus</option>
                      <option value="Sweetlegs Plus2">SweetLegs Plus2</option>
                      <option value="Sweetlegs Petite">SweetLegs Petite</option>
                      <option value="Sweetlegs Kids">SweetLegs Kids</option>
                      <option value="Sweetlegs Athleisure">SweetLegs Athleisure</option>
                      <option value="Sweetlegs Maternity">SweetLegs Maternity</option>
                      <option value="sunglasses">Sunglasses</option>
                      <option value="sweettops">SweetTops</option>
                      <option value="marketing">Marketing Materials</option>
                      <option value="crops">Crops</option>    
                      <option value="sale-">ID Sale Prints</option>     
                      <option value="safe">From The Vault</option>  
                      <option value="almostGone">Almost Gone</option>  
               </select>
            </div>
            <div class="fBox subs">
                <label>&nbsp;</label>
                <input value="Show All Products" type="button" class="clearMe">
            </div>
        </div>

      <input class="totalLineItem" data-total={{ cart.items | size }} data-initialdiscountableitem= {{discountableItem}} type=hidden />   
       <input class="customerTag" type=hidden value={{customer.tags}}  /> 
      {% if current_page == 1 %} 
         <div class="content" style="background: #F7F7F7; margin-bottom: 2rem">
            <table id="quick-order-content">
              <thead style="background: #F7F7F7;">
                <tr>
                  <th class="imgHeading" style="font-size: 18px; text-align:left; padding-left:20px">Featured</th>
                  <th class="titleHeading">Product</th>
                  <th  class="priceHeading">Price</th>
                  <th class="qtyHeading">Quantity</th>
                </tr>  
              </thead>  
              <tbody id="featuredList">
                  {% for product in collectionFeatured.products %}
                    {% assign productTags = product.tags | join: ', ' %}
                    {% unless productTags contains 'coming_soon' %}
                    {% if product.available and product.tags%}
                        {% include 'quickorder' %}
                    {% endif %}
                      {% endunless %}
                  {% endfor %}
                   {% for product in collectionVault.products %}
                    {% if product.available%}
                        {% include 'quickorder' %}
                    {% endif %}
                  {% endfor %}      
                </tbody>
            </table>
         </div>
      {% endif %}
      <div class="content">
          <table id="quick-order-content">
            <thead>
                <tr>
                  <th class="imgHeading" style="font-size: 18px; text-align:left; padding-left:20px"></th>
                  <th class="titleHeading"></th>
                  <th  class="priceHeading"></th>
                  <th class="qtyHeading"></th>
                </tr>  
            </thead> 
            <tbody id="prodList">            
                {% for product in collection.products %}
                  {% if product.available %}
                      {% if product.tags contains 'vault' or product.tags contains 'featured' %}
                      {% else %} 
                         {% assign productTags = product.tags | join: ', ' %}
                    {% unless productTags contains 'coming_soon' %}
                      {% include 'quickorder' %}
                      {% endunless %}
                      {% endif %}
                  {% endif %}
                {% endfor %}
            </tbody>
          </table>
      </div>
     
        <p class="zeroResults hideMe">No Products Found</p>
        <div class="orderSubmit dummyOrder">          
        </div>  
  
    </div><!-- row -->
    </div><!-- large-12 columns -->
  
    <div class="orderSubmit realOrderSubmit  orderSubmitFloat" style="bottom: 10px" >
      <div class="row" >
        <div class="large-12 columns">  
          <a class="submitCheckout" href="/cart">Continue to Checkout</a>
<!--           <input type="submit" id="bulkCheckout" value="Continue to Checkout" style="margin-left: 6px" /> -->
          <span class="scrollTop" style="display:none">
      <i class="fa fa-angle-up" style="cursor: pointer;font-size: 30px;text-align: center;color:white"></i>
      </span>
           <span class="cartItem" style="display:none" >
             <span style="font-size: 14px">{{cart.item_count}}</span></br>
             ITEMS
      </span>
          {% comment %}<a class="submitCheckout" href="/checkout">Checkout</a> {% endcomment %}
        </div>
      </div>
    </div>
 
  
  {% else %}
    <p>There are no products in this view.</p>
  {% endif %}
  
  
    
   <a id="load-more-button" class="btn" style="display:none;" 
         data-num-pages="{{ paginate.pages }}" 
         data-current-page="{{ paginate.current_page }}" 
         href="{{ paginate.next.url }}"></a>

      {{ '//code.jquery.com/jquery-1.12.3.min.js' | script_tag }}
      <script>
        (function($){
     
          $(document).on('ready', function(e){      
             setTimeout(function(e) {$("#spinner").css('display', 'none')}, 500);    
            if(typeof carts != 'undefined') {
              setTimeout(function(e) {displayQty()}, 0);
              setTimeout(function(e) {
                showDiscount(discountableItem, page - 50);
              }, 0);
            } else {
              setTimeout(function(e) {displayQty()}, 0);
              setTimeout(function(e) {
                showDiscount(0, page - 50);
              }, 0);
            }
            // Identifier of single item
            var itemSelector = "table tr";

            // This is the container that the items you're calling will be added
            var itemContainer = $(itemSelector).closest('#prodList');

            // Selector for load more button
            var loadMoreButtonSelector = "#load-more-button";

            // Selector for load more loading indicator
            var loadMoreError = $('.plus-ajax-error');
            e.preventDefault();
            var loadMore = $(loadMoreButtonSelector);
            var loadMoreCount = loadMore.data("num-pages");            
            loadMoreError.remove();
            for(i=2; i<=loadMoreCount; i++) {  
              var loadMoreURL = `/pages/bulk-order-form?page=${i}`
                $.ajax({
                  type: 'GET',
                  url: loadMoreURL,
                  beforeSend: function() {
                    loadMore.hide();
                  },
                  success: function(data) {
                    var filteredData = $(data).find( itemSelector );
                    var nextLoadMore = $(data).find( loadMoreButtonSelector );
                    var nextLoadMoreUrl = nextLoadMore.attr('href');
                    var loadMoreCurrent = nextLoadMore.data('current-page');

                    filteredData.appendTo( itemContainer );

                    if( loadMoreCurrent < loadMoreCount ){
                      loadMore.attr('href', nextLoadMoreUrl).show();
                    }
                  if(typeof carts != 'undefined') {
                      setTimeout(function(e) {displayQty()}, 0);
                      setTimeout(function(e) {
                        showDiscount(discountableItem, page - 50);
                      }, 0);
                    }else {
                      setTimeout(function(e) {displayQty()}, 0);
                      setTimeout(function(e) {
                        showDiscount(0, page - 50);
                      }, 0);
                    }
                  },
                  failure: function() {
                    loadMore.show();
                    $(loadMoreButtonSelector).after('<div class="errors plus-ajax-error">There was an error.</div>');
                  },
                  dataType: "html"
                });
              {% if paginate.next.is_link %} 
                $(loadMoreButtonSelector).show();
                $(loadMoreButtonSelector).click();
              {% endif %}
          }

          });
        })(jQuery);
      </script>

{% endpaginate %}
</form>

      </div><!--paginationForm-->
 

{% if collection.products_count > 0 %}
        
{{ 'quick-order.js' | asset_url | script_tag }} 
<script type="text/javascript">
/**
 * JQuery ListFilter plugin
 *
 * Filters a HTML list (defined as <element data-listfilter-list="ul#some-list">)
 *
 * Usage:
 *   $('form').listFilter();
 *
 * The list items can be filtered by an attribute:
 *   <element data-listfilter-by-attribute="true"> ("data-listfilter-index" as default)
 *   <element data-listfilter-by-attribute="data-title">
 *
 * Note: index value in data attribute should be lowecased.
 *
 * or by children element:
 *   <element data-listfilter-by-element="h3:contains({{value}})">
 *
 * Note: by-attribute method is much faster than byElement, because of CSS3 native selector usage
 *
 *
 * @version 0.2
 * @since 2014-01
 * @author Mateusz Janik
 *
 */
// !function(t){var e="listfilter";!function(t){var n="listFilter";t.fn[n]=function(i){var a=t.extend({},t.fn[n].defaults,i);return this.each(function(){function n(n){if(o)if(""===n.val())r.removeClass(e+"-item--hidden");else{var i=o.replace("{{value}}",n.val()),a=r.removeClass(e+"-item--hidden").filter(function(){return t(this).find(i).length>0});r.not(a).addClass(e+"-item--hidden")}else u&&(""===n.val()?c.html(""):c.html("#"+h+" > "+f+":not(["+u+'*="'+n.val().toLowerCase()+'"]) { display: none; }'))}var i=t(this),l=i.find("input[type=search]"),s=i.find("button"),d=t(i.data(e+"List")),r=d.children().addClass("listfilter-item"),f=i.data(e+"ListItem")||"",o=i.data(e+"ByElement"),u=i.data(e+"ByAttribute");if(u){var h=d[0].id;if(!h)return!1;var c=t('<style type="text/css" id="listfilter-style-'+Math.round((new Date).getTime()+100*Math.random())+'"></style>').appendTo("head");u="string"==typeof u?u:"data-"+e+"-index"}s.length?s.on("click",function(){n(l)}):l.on(a.eventType,function(){n(l)}).on("search",function(){""===l.val()&&n(l)})}),this},t.fn[n].defaults={eventType:"keyup"}}(jQuery)}(window);
// $('.filterBox input').val('');

// $('.filterBox').listFilter({
//         // eventType: 'change'
//   }); 

  
var xv = 1;
page = 0;
function displayQty() {   
  if(typeof carts != 'undefined') {
      $('table').find('td .quantity.field').slice(page).each(function(i, pp) {
       result = carts.filter(item => item.variantId == $(pp).data('id'));
         if(result.length > 0) {
           $(pp).val(result[0].quantity);
         }
    });
  }   
  page = page + 50; 
}
  



//check line item to show discount in cart
function checkLineItem(totalLine) {
  var totalLine = 0;
  $('input.quantity.field').each(function() {
    if(Number($(this).val()) > 0) {
      totalLine += 1;
    }
   });
   if (totalLine > 200 ) {
     $(".modal-body").text("You have hit the maximum line items allowed in your cart, please checkout to avoid any issues."); 
     $('.goCart').removeClass('hideMe');
     $('.btn.btn-default.closeModal').addClass('hideMe');
     $('.popUpModal').fadeIn();
     $('.totalLineItem').data('total', parseInt($('.totalLineItem').data('total')) - 1);    
   }  
}

$(document).ready(function() {  
//    for(var i = 1; i <= 10 ; i++) {
//         $.getJSON(`/collections/quick-order/products.json?limit=50&page=${i}`, function(response){
//           console.log(response);
//              getData(response, href);
//          });
//    }
 
  $('.quantity.field').keydown(function(e) {
    
          // Allow: backspace, delete, tab, escape, enter and .
    if ($.inArray(e.keyCode, [46, 8, 9 , 27, 110, 190]) !== -1 ||
      // Allow: Ctrl+A
      (e.keyCode == 65 && e.ctrlKey === true) ||
      // Allow: home, end, left, right
      (e.keyCode >= 35 && e.keyCode <= 39)) {
      // let it happen, don't do anything
      return;
    }
    // Ensure that it is a number and stop the keypress
    if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57 || e.keyCode < 13)) && (e.keyCode < 96 || e.keyCode > 105)) {
     
      e.preventDefault();
    }
  });
  
//   $('.filterBox .form-control').keydown(function(e) {
//  console.log('this hit');
//           // Allow: backspace, delete, tab, escape, enter and .
//     if ($.inArray(e.keyCode, [46 , 9 , 27, 110, 190]) !== -1 ||
//       // Allow: Ctrl+A
//       (e.keyCode == 65 && e.ctrlKey === true) ||
//       // Allow: home, end, left, right
//       (e.keyCode >= 35 && e.keyCode <= 39)) {
//       // let it happen, don't do anything
//       return false;
//     }
//     // Ensure that it is a number and stop the keypress
//     if (e.keyCode == 13) {
//         e.preventDefault();
//        $('.filterBox .form-control').blur();
//     }
//   });
  
 
  
  
  $.fn.isInViewport = function() {
    var elementTop = $(this).offset().top + 78;
    var elementBottom = elementTop + $(this).outerHeight();
    
    var viewportTop = $(window).scrollTop();
    var viewportBottom = viewportTop + $(window).height();
    
    return elementBottom > viewportTop && elementTop < viewportBottom;
  };
  
  
    floatMe();
  
  
  $(window).on('resize scroll', function() {
    
    floatMe();
  
    // console.log('resize scroll');
  });
  
  
  

  var xv = 1;
  var xt;
 
  
  
 
  $('.catFilter').val('');
  $('.catFilter').change(function() {
    var cv = $(this).val().toLowerCase();
    if(cv == 'almostgone') {
      $('#prodList tr[data-inventory-quantity]').removeClass('hideMe');
      $('tr[data-inventory-quantity]').filter(function() { 
        return parseInt($(this).data('inventory-quantity')) > 10 || parseInt($(this).data('inventory-quantity')) == 0;
      }).addClass('hideMe');
    }else if (cv != '') {
      $('#featuredList tr').addClass('hideMe');
      $('#featuredList tr[data-tag*="'+cv+'"]').removeClass('hideMe');
      $('#prodList tr').addClass('hideMe');
      $('#prodList tr[data-tag*="'+cv+'"]').removeClass('hideMe');
    } else {
      $('#featuredList tr').removeClass('hideMe');
      $('#prodList tr').removeClass('hideMe');
      
    }
    
    xv = $('#prodList tr:visible').size();
    if (xv == 0) {
      $('.zeroResults').removeClass('hideMe');
    } else {
      $('.zeroResults').addClass('hideMe')
    }  
    floatMe();
    
  });
  
  
  
//   $('.filterBox .form-control').keyup(function() {
//     console.log('this hit');
//     clearTimeout(xt);
//     xt = setTimeout(function(){ 
//       xv = $('#prodList tr:visible').size();
//       if (xv == 0) {
//         $('.zeroResults').removeClass('hideMe');
//       } else {
//         $('.zeroResults').addClass('hideMe')
//       }
      
//       floatMe();
      
//     }, 10);
    
    
//   });


   $('.clearMe').click(function() {
      $('.filterBox .form-control').val('');
      $('.catFilter').val('');  
      $('.filterBox .form-control').trigger('keyup').trigger('keydown').trigger('change');
      $('style[id*="listfilter-style"]').html('');
      $('#prodList tr').removeClass('hideMe');  
      $('#featuredList tr').removeClass('hideMe');
  });
   
// end ready  
});  
  
function floatMe() {
  if ($('.dummyOrder').isInViewport()) {    
        $('.realOrderSubmit ').removeClass('orderSubmitFloat');
      } else {
        if ($('#shopify-section-footer').isInViewport()) {
          $('.realOrderSubmit ').removeClass('orderSubmitFloat');
        } else {
            $('.realOrderSubmit ').addClass('orderSubmitFloat');
        }
        
        if ($('#prodList').isInViewport()) {
          $('.realOrderSubmit ').addClass('orderSubmitFloat');
        } else {
            $('.realOrderSubmit ').removeClass('orderSubmitFloat');
        }
        
      }
}

$(document).ready(function(){
    var checkCloseX = 0
    changeQty = false;
    $(window).scroll(function (event) {
      var scroll = $(window).scrollTop();
      if(scroll > 600){
        $('.scrollTop').fadeIn(500);
        $('.cartItem').fadeIn(500);
      } else {
        $('.scrollTop').fadeOut(500);
        $('.cartItem').fadeOut(500);
      }
   }); 
  var url = window.location.href;  
  $(document).on('focusin','.quantity.field', function(e){
    $(this).data('val', $(this).val());
  }).on('change','.quantity.field',function(e){
    e.stopPropagation();
    changeQty = true;
    $(this).attr('update', 'updated');
    checkLineItem(); 
    var totalPrice = 0;
    var initialdiscountableitem = parseInt($('.totalLineItem').data('initialdiscountableitem'));
    discountableItem = countDiscountableItem();
    $('.totalLineItem').data('initialdiscountableitem', discountableItem);
     var sum = 0;
     var price = 0.00;
      $('input.quantity.field').each(function() {
          sum += Number($(this).val());
      });
    $('td.productPrice').each(function() {
      var pricePerItem = $(this).text().split('$');
      var qty = parseInt($(this).parent('tr').find('td.prodListQty').find('input.quantity.field').val());
      if(qty > 0) {
        totalPrice += parseFloat(pricePerItem[pricePerItem.length-1]) * qty; 
      }
      });
     let lineItemCount = 25;
    if(customerTags.includes("new")) {
      lineItemCount = 50;
    }
    
     if(initialdiscountableitem < lineItemCount && discountableItem >= lineItemCount) { 
      showDiscount(discountableItem);  
    } else if (initialdiscountableitem >= lineItemCount && discountableItem < lineItemCount){
      showDiscount(discountableItem);           
    }
    $('.cart_items_number.counter_number.animated.rubberBand').text(sum);
    $('span.cartItem span').text(sum);
    $('span.money').text('$'+ totalPrice.toFixed(2));
    var check = true;
    var max = parseInt($(this).parent().find('.quantity.field').attr('max'), 10);
    if(max >= 25) {
      max = 25;
    }
    var value = parseInt($(this).parent().find('.quantity.field').val(), 10) || 0;
    var prev = $(this).data('val');
    var initialCartValue = parseInt($('.cart_items_number.counter_number.animated.rubberBand').text());
    var $id = $(this).parent().find('input.variantId').val();
    var $url = $(this).parent().find('input.variantUrl').val();
    var $qty = $(this).parent().find('.quantity.field');
    var initialLineItemValue = parseInt($qty.data('info'));
    let totalLine = parseInt($('.totalLineItem').data('total'));
    var tags = $(this).parent('td').parent('tr').attr('data-tag-array');
    var limit = max;
    tags.split(",").forEach(tag => {
      if(tag.trim().startsWith("limit")){
        limit = parseInt(tag.split("limit").pop());
      }    
    })
     if (value > max || value > limit ) { 
        $('.goCart').addClass('hideMe');
        $(this).parent().find('.max').remove();
        $(this).parent().find('.prodListPlus').css('display', 'none');     
        $(this).parent().append('<i class="max" title="MAXIMUM UNITS REACHED FOR THIS ITEM">max</i>');
        $(this).parent().find('.quantity.field').val(limit).trigger('change');
          reload = false;
     } else if(value < max && value < limit && $(this).parent().find('.max')) {
       $(this).parent().find('.prodListPlus').css('display', 'inline'); 
       $(this).parent().find('.max').css('display', 'none'); 
     }

    if(parseInt($qty.val()) == 0 ) {
      $('.totalLineItem').data('total', parseInt($('.totalLineItem').data('total')) - 1);
    }
   if(prev == 0 && initialLineItemValue == 0 && parseInt($qty.val()) != 0 ) {
    $('.totalLineItem').data('total', parseInt($('.totalLineItem').data('total')) + 1);
   }
  
    var currentVal = parseInt($qty.val());
    if (!isNaN(currentVal)) {
        $qty.val(currentVal);
    }
    if (prev != 0 && initialLineItemValue == 0 ){
    var updateValue = initialCartValue + (currentVal - prev);
    } else {
      var updateValue = initialCartValue + (currentVal - initialLineItemValue);
    }
    $qty.data('info', currentVal);  
    if($qty.val() == 0 ) {
      var answer = confirm("Are you sure you want to remove the  product?"); 
      var data = {
        quantity: 0,
        id: $id
      }
    }
    if (answer == false) {
      $qty.val(initialLineItemValue);  
    }        
});
  
  
  var int00;
  var handled = false;
  $(document).on("click touchstart",'.prodListPlus', function(e){
       e.stopImmediatePropagation();
          if(e.type == "touchend") {
              handled = true;              
              var $qty = $(this).parent().find('.quantity.field');
              var currentVal = parseInt($qty.val());
              $(this).parent().find('.quantity.field').val(currentVal + 1).trigger('change');
          }
          else if(e.type == "click" && !handled) {
              
            var $qty = $(this).parent().find('.quantity.field');
            var currentVal = parseInt($qty.val());
            $(this).parent().find('.quantity.field').val(currentVal + 1).trigger('change');
          }
          else {
              handled = false;
          }                  
  });
  
    
     $(document).on("click",'.prodListMinus', function(e){
        e.stopImmediatePropagation();
          if(e.type == "touchend") {
              handled = true;              
              var $qty = $(this).parent().find('.quantity.field');
              var currentVal = parseInt($qty.val());
              if(currentVal > 0) {
                  $(this).parent().find('.quantity.field').val(currentVal - 1).trigger('change');
              }
          }
          else if(e.type == "click" && !handled) {
             var $qty = $(this).parent().find('.quantity.field');
              var currentVal = parseInt($qty.val());
              if(currentVal > 0) {
                  $(this).parent().find('.quantity.field').val(currentVal - 1).trigger('change');
              }
          } else {
              handled = false;
          }               
        
      });
  
  
  $(".fa.fa-angle-up").on('click',function(){
      $(window).scrollTop(0);
  })
   
   //save the change before leaving the page
  var  validNavigation = false;
  $(document).on('click', 'a', function(e) { 
   validNavigation = true;
   $("body").css("cursor", "progress");
    href = $(this).attr("href");
   if(changeQty == true) {
     e.preventDefault();
     $("#spinner p").text('Saving your cart ...');
     $("#spinner").css('display', 'block');
     href = $(this).attr("href");
     $('.orderForm').find('.quantity.field').each(function() {
     var xname = $(this).attr('data-name'); 
       if ($(this).attr('update') == 'updated'){
       $(this).attr('name', xname); 
     } else {
       $(this).attr('name', '');  
     }
    }); 
     data = $('.orderForm').serialize();
     postToCart(data, href, false);  
   }
 }); 



  //save when window unload
  var isOnIOS = navigator.userAgent.match(/iPad/i)|| navigator.userAgent.match(/iPhone/i);
  var eventName = isOnIOS ? "pagehide" : "beforeunload";
  window.addEventListener("load", function() { $('.prodListPlus, .prodListMinus').removeClass('hideMe')}, false); 
  window.addEventListener(eventName, function (event) { 
    if(!validNavigation) {
      $('.orderForm').find('.quantity.field').each(function() {
           var xname = $(this).attr('data-name'); 
           if ($(this).attr('update') == 'updated') {
             $(this).attr('name', xname); 
           } else {
             $(this).attr('name', '');  
           }
          }); 
         $.ajax({
            url:'/cart',
            type:'post',
            data:$('.orderForm').serialize(),
            async: false, 
            success:function(item){

            }
        });
        return "Do you really want to close?";   
    }
  });
  
 
  $(window).load(function() {
  
  });
  $(document).on('click touchstart','.max', function(e) {
    $(this).before(`<span class="tooltipMax">MAX LIMIT REACHED FOR ITEM.</span>`);
     $('.tooltipMax').fadeOut( 3600);
  });
  
  
//   Search filter 
    $(".form-control").on("keyup", function() {
      var value = $(this).val().toLowerCase();
        $("#prodList tr").filter(function() {
          if($(this).attr('data-filter-name')) {
            title = $(this).attr('data-filter-name').toLowerCase();
          } else {
            title = '';
          }

            $(this).toggle(title.indexOf(value) > -1)       
        });
        $("#featuredList tr").filter(function() {
      if($(this).attr('data-filter-name')) {
            title = $(this).attr('data-filter-name').toLowerCase();
          } else {
            title = '';
          }
            $(this).toggle(title.indexOf(value) > -1)
        });
    });
})  
</script>
                    
{% endif %}            
    </article>
  </div>
</div>

