{%- if section.settings.image -%}
  {%- assign img_object = section.settings.image -%}
  {%- assign img_small = section.settings.image | img_url: '18x' -%}
  {%- assign img_api = section.settings.image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
{%- else -%}
  {%- assign img_object = 'blank.svg' | asset_url -%}
  {%- assign img_small =  'blank.svg' | asset_url -%}
  {%- assign img_api = 'blank.svg' | asset_url -%}
{%- endif -%}
{%- assign img_tiny = section.settings.image | img_url: '1x1' -%}
{% if section.settings.title_size_override %}
<style>
  #FeaturedImage-{{ section.id }} .title--flex{ font-size: {{ section.settings.title_size }}px;}
</style>
{% endif %}
<div class="homepage-image banner-image-section fade-in-child preventOverflow {{ section.settings.height }} {{ section.settings.color }}" data-section-id="{{ section.id }}" data-section-type="parallax" id="FeaturedImage-{{ section.id }}"
  {% if section.settings.parallax %}
    data-parallax-src="{{ img_small }}"
    data-src="{{ img_api }}"
    data-widths="[180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 2048, 2450, 2700, 3000, 3350, 3750, 4100, 4480]"
    data-aspectratio="{{  section.settings.image.aspect_ratio }}"
    data-sizes="auto"
    data-alt="{{ section.settings.image.alt | default: section.settings.title }}"
    style="background-image: url('{{ section.settings.image | img_url: '1x1' }}');"
  {% endif %}>
  {% if section.settings.link_text == '' and section.settings.link and section.settings.button_image == nil %}
    <a href="{{ section.settings.link }}">
  {% endif %}
  <div class="{{ section.settings.content_position }}">
    <div class="{{ section.settings.text_align }} banner-content preventOverflowContent">
      {%- if section.settings.button_image -%}
        {%- assign img_button = section.settings.button_image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
        <a href="{{ section.settings.link }}">
          <img class="lazyload image--flex"
          alt="{{ section.settings.button_image.alt | default: section.settings.link_text }}"
          src="{{ section.settings.button_image | img_url: '180x' }}"
          data-src="{{ img_button }}"
          data-widths="[180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 2048, 2450, 2700, 3000, 3350, 3750, 4100, 4480]"
          data-aspectratio="{{  section.settings.button_image.aspect_ratio }}"
          data-sizes="auto"/>
          <noscript>
            <img src="{{ section.settings.button_image | img_url: '540x' }}" alt="{{ section.settings.button_image.alt | default: section.settings.link_text }}" class="image--flex" />
          </noscript>
        </a>
      {%- else -%}
        {% unless section.settings.title == '' %}<h1 class="title--flex{% if section.settings.add_flourish == true %} flourish{% endif %}">{{ section.settings.title | escape }}</h1>{% endunless %}
        {% unless section.settings.description == '' %}<p class="">{{ section.settings.description }}</p>{% endunless %}
        {% unless section.settings.link_text == '' %}<a class="{{ section.settings.button_style }}" href="{{ section.settings.link }}">{{ section.settings.link_text | escape }}</a>{% endunless %}
      {%- endif -%}
    </div>
  </div>
  <div class="image-overlay image-overlay-{{ section.settings.overlay_opacity }}"{% if section.settings.custom_overlay_color == true %} style="background-color: {{ section.settings.overlay_color }};"{% endif %}></div>
  {% if section.settings.height == 'use_image' %}
    <div class="lazy-image" style="padding-top:{{ 1 | divided_by: section.settings.image.aspect_ratio | times: 100}}%; background-image: url('{{ section.settings.image | img_url: '1x1' }}');">
      <img class="lazyload fade-in" {% if section.settings.parallax %} style="opacity: 0;"{% endif %}
        alt="{{ section.settings.image.alt | default: shop.name }}"
        data-src="{{ img_api }}"
        data-widths="[180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 2048, 2450, 2700, 3000, 3350, 3750, 4100, 4480]"
        data-aspectratio="{{  section.settings.image.aspect_ratio }}"
        data-parent-fit="cover"
        data-sizes="auto"/>
    </div>
  {% endif %}
  {% if section.settings.parallax == false and section.settings.height != 'use_image' %}
    {% if section.settings.mobile_stack %}
      <div class="background-size-cover lazyload medium--hide large--hide" data-bgset="{% include 'bgset', image: img_tiny %}" role="img" aria-label="{{ img_object.alt }}"></div>
      <div class="background-size-cover lazyload small--hide" data-bgset="{% include 'bgset', image: img_object %}" role="img" aria-label="{{ img_object.alt }}"></div>
    {% else %}
      <div class="background-size-cover lazyload" data-bgset="{% include 'bgset', image: img_object %}" role="img" aria-label="{{ img_object.alt }}"></div>
    {% endif %}
  {% endif %}
  {% if section.settings.link_text == '' and section.settings.link and section.settings.button_image == nil %}
    </a>
  {% endif %}
  {% if section.settings.height == 'use_screen_full' %}
    <div class="scroll_icon_wrap">
      <a href="#scroll-{{ section.id }}" class="scroll_link bloop">
        <span class="scroll_icon">{% include 'svg-down' %}</span>
      </a>
    </div>
    <div class="scroll__link" id="scroll-{{ section.id }}"></div>
  {% endif %}
  <noscript>
    <img src="{{ img_object | img_url: '1440x' }}" alt="{{ img_object.alt | default: section.settings.title }}" class="responsive-wide-image"/>
  </noscript>
</div>
{% if section.settings.mobile_stack %}
  <div class="lazy-image medium--hide large--hide" style="padding-top:{{ 1 | divided_by: section.settings.image.aspect_ratio | times: 100}}%; background-image: url('{{ section.settings.image | img_url: '1x1' }}');">
    <img class="lazyload fade-in" {% if section.settings.parallax %} style="opacity: 0;"{% endif %}
         alt="{{ section.settings.image.alt | default: shop.name }}"
         data-src="{{ img_api }}"
         data-widths="[180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 2048, 2450, 2700, 3000, 3350, 3750, 4100, 4480]"
         data-aspectratio="{{  section.settings.image.aspect_ratio }}"
         data-parent-fit="cover"
         data-sizes="auto"/>
  </div>
{% endif %}